library(tidyverse)
library(readr)
menu <- read_csv("06_data_visualisation/r/menu.csv")
katki <- read_csv("06_data_visualisation/r/Katki-i-lyzhnye-trassy-Sankt-Peterburga.csv")
glimpse(katki)






katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'бесплатно'] <- "Бесплатно"
katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'платно'] <- "Платно"
katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'Бесплатно/ платно'] <- "Платно/бесплатно"
katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'Платно, бесплатно'] <- "Платно/бесплатно"
katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'Платно/ бесплатно'] <- "Платно/бесплатно"
katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'только для обучающихся ГБПОУ "Академия ледовых видов спорта "Динамо Санкт-Петербург"'] <- "ГБПОУ 'Динамо Санкт-Петербург'"
katki$`Стоимость услуг (платно/ бесплатно)`[katki$`Стоимость услуг (платно/ бесплатно)` == 'Только для обучающихся школы 438'] <- "Школа 438"
katki$`Стоимость услуг (платно/ бесплатно)`[is.na(katki$`Стоимость услуг (платно/ бесплатно)`)] <- "нет данных"


a <- "лыжная трасса"
b <- "каток"
ve1 <- as.vector(data.frame(table(katki$`Тип (каток/лыжная трасса)`))[,1])
ve2 <- c(a,b,b,b,b,b,a,a,a,a,a,b)
length(ve1) == length(ve2)
for (i in 1:length(ve1)){
  print(ve1[i])
  print(ve2[i])
  katki$`Тип (каток/лыжная трасса)`[katki$`Тип (каток/лыжная трасса)` == ve1[i]] <- ve2[i]
  
}

a <- "работающий"
b <- "временно приостановлено посещение"
ve1 <- as.vector(data.frame(table(katki$`Статус (работающий/ временно приостановлено посещение)`))[,1])
length(ve1) 
length(ve2) 
ve2 <- c(b,b,b,b,b,b,b,b,b,b,a,a,a,a)
length(ve1) == length(ve2)
for (i in 1:length(ve1)){
  print(ve1[i])
  print(ve2[i])
  katki$`Статус (работающий/ временно приостановлено посещение)`[katki$`Статус (работающий/ временно приостановлено посещение)` == ve1[i]] <- ve2[i]
  
}

table(katki$`Статус (работающий/ временно приостановлено посещение)`)

a <- "день"
b <- "ночь"
c <- "день и ночь"
ve1 <- as.vector(data.frame(table(katki$`Время суток (день/ ночь/ день и ночь)`))[,1])
length(ve1) 
ve2 <- c(a,a,c,c,c,c,c,c,b)
length(ve2) 

length(ve1) == length(ve2)
for (i in 1:length(ve1)){
  print(ve1[i])
  print(ve2[i])
  katki$`Время суток (день/ ночь/ день и ночь)`[katki$`Время суток (день/ ночь/ день и ночь)` == ve1[i]] <- ve2[i]
  
}
table(katki$`Время суток (день/ ночь/ день и ночь)`)


a <- "открытый"
b <- "закрытый"
ve1 <- as.vector(data.frame(table(katki$`Расположение (открытый/закрытый)` ))[,1])
length(ve1) 
ve2 <- c(b,b,b,b,b,a,a,a,a)
length(ve2) 

length(ve1) == length(ve2)
for (i in 1:length(ve1)){
  print(ve1[i])
  print(ve2[i])
  katki$`Расположение (открытый/закрытый)`[katki$`Расположение (открытый/закрытый)` == ve1[i]] <- ve2[i]
  
}
table(katki$`Расположение (открытый/закрытый)`)

a <- "доступен"
b <- "не доступен"
c <- "нет информации"
ve1 <- as.vector(data.frame(table(katki$`Доступность для лиц с нарушениями здоровья`))[,1])
length(ve1) 
ve2 <- c(c,a,a,a,a,a,a,a,a,
         a,a,a,a,a,a,a,a,a,
         a,a,a,a,a,a,a,a,a,
         b,b,b,a,a,a,a,a)
length(ve2) 

length(ve1) == length(ve2)
for (i in 1:length(ve1)){
  print(ve1[i])
  print(ve2[i])
  katki$`Доступность для лиц с нарушениями здоровья`[katki$`Доступность для лиц с нарушениями здоровья` == ve1[i]] <- ve2[i]
  
}
katki$`Доступность для лиц с нарушениями здоровья`[is.na(katki$`Доступность для лиц с нарушениями здоровья`)] <- c
table(katki$`Доступность для лиц с нарушениями здоровья`)


katki$`Наличие проката инвентаря (да/нет)` <- ifelse(katki$`Наличие проката инвентаря (да/нет)`==TRUE, "да",  "нет")
table(katki$`Наличие проката инвентаря (да/нет)`)

katki$`Наличие услуг инструктора (да/нет)`<- ifelse(katki$`Наличие услуг инструктора (да/нет)`==TRUE, "да",  "нет")
table(katki$`Наличие услуг инструктора (да/нет)`)

katki$`Наличие помещения для переодевания (да/нет)`<- ifelse(katki$`Наличие помещения для переодевания (да/нет)`==TRUE, "да",  "нет")
table(katki$`Наличие помещения для переодевания (да/нет)`)

katki$`Наличие камеры хранения (да/нет)`<- ifelse(katki$`Наличие камеры хранения (да/нет)`==TRUE, "да",  "нет")
table(katki$`Наличие камеры хранения (да/нет)`)

katki$`Наличие кафе на территории (да/нет)`<- ifelse(katki$`Наличие кафе на территории (да/нет)`==TRUE, "да",  "нет")
table(katki$`Наличие кафе на территории (да/нет)`)


a <- "да"
b <- "нет"
ve1 <- as.vector(data.frame(table(katki$Освещение))[,1])
length(ve1) 
ve2 <- c(a,a,a,a,a,a,
         a,a,a,a,a,
         b,b,a,b,b,b,
         a,a,a,a,a)
length(ve2) 

length(ve1) == length(ve2)
for (i in 1:length(ve1)){
  print(ve1[i])
  print(ve2[i])
  katki$Освещение[katki$Освещение == ve1[i]] <- ve2[i]
  
}
table(katki$Освещение)

glimpse(katki)

write_csv(katki,"06_data_visualisation/r/katki_spb.csv")


